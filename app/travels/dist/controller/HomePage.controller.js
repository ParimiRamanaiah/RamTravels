sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/model/odata/v2/ODataModel","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/Fragment","sap/ui/core/ValueState"],(e,t,s,i,a,o,r)=>{"use strict";return e.extend("com.ram.travels.controller.HomePage",{onInit(){var e="/odata/v2/user/";this.oModel=new s(e,true);this.getView().setModel(this.oModel)},onRegister:async function(){if(!this.registerDialog){this.registerDialog=await o.load({name:"com.ram.travels.view.RegisterDialog",controller:this});this.getView().addDependent(this.registerDialog)}this.registerDialog.open()},onCloseRegister:function(){this.registerDialog.close()},onSubmitRegister:function(){let e=sap.ui.getCore().byId("firstName").getValue();let t=sap.ui.getCore().byId("lastName").getValue();let s=sap.ui.getCore().byId("mobileNumber").getValue();let i=sap.ui.getCore().byId("gender").getValue();let o=sap.ui.getCore().byId("emailId").getValue();let l=sap.ui.getCore().byId("password").getValue();let n=sap.ui.getCore().byId("confirmPassword").getValue();if(!e||!t||!s||!i||!o||!l){a.information("Please fill in all required fields.");return}if(s.length!==10){sap.ui.getCore().byId("mobileNumber").setValueState(r.Error);sap.ui.getCore().byId("mobileNumber").setValueStateText("Mobile Number should be exactly 10 digits");return}else{sap.ui.getCore().byId("mobileNumber").setValueState(r.None)}let g=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;if(!g.test(o)){sap.ui.getCore().byId("emailId").setValueState(r.Error);sap.ui.getCore().byId("emailId").setValueStateText("Please Enter a valid email address.");return}else{sap.ui.getCore().byId("emailId").setValueState(r.None)}let u=/^(?=.*[!@#$%^&*(),.?":{}|<>]).{9,}$/;if(!u.test(l)){sap.ui.getCore().byId("password").setValueState(r.Error);sap.ui.getCore().byId("password").setValueStateText("Password must be longer than 8 characters and atleast one special character.");return}else{sap.ui.getCore().byId("password").setValueState(r.None)}if(l!==n){a.information("Password and Confirm Password should be the same.");return}const d={firstName:e,lastName:t,mobileNumber:s,gender:i,emailId:o,Password:l};this.oModel.create("/Users",d,{success:e=>{if(e.message.startsWith("Registration")){a.success(e.message,{onClose:function(e){if(e==="OK"){this.onRegisterClear();this.registerDialog.close()}}.bind(this)})}else if(e.message.startsWith("A user")){a.information(e.message)}},error:e=>{a.error("Registration failed!");console.error("Error:",e)}})},onRegisterClear:function(){sap.ui.getCore().byId("firstName").setValue("");sap.ui.getCore().byId("lastName").setValue("");sap.ui.getCore().byId("mobileNumber").setValue("");sap.ui.getCore().byId("gender").setValue("");sap.ui.getCore().byId("emailId").setValue("");sap.ui.getCore().byId("password").setValue("");sap.ui.getCore().byId("confirmPassword").setValue("")},onLogin:async function(){if(this.loginDialog===undefined){this.loginDialog=sap.ui.xmlfragment(this.getView().getId(),"com.ram.travels.view.LoginDialog",this);this.getView().addDependent(this.loginDialog)}this.loginDialog.open()},onCloseLogin:function(){this.loginDialog.close()},onLoginClear:function(){this.getView().byId("idUserName").setValue("");this.getView().byId("idPassword").setValue("")},onSubmitLogin:function(){let e=this.getView().byId("idUserName").getValue().trim();let t=this.getView().byId("idPassword").getValue().trim();this.onSubmitLogin.count=this.onSubmitLogin.count||0;if(!e||!t){a.information("Please fill in all required fields.");return}this.oModel.read("/login",{urlParameters:{emailId:e,password:t},success:function(e){console.log("req",e);if(e.login.message.startsWith("Login")){a.success(e.login.message,{onClose:function(e){if(e==="OK"){this.onLoginClear();this.loginDialog.close()}}.bind(this)})}else{a.information(e.login.message)}}.bind(this)})}})});
//# sourceMappingURL=HomePage.controller.js.map