sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/model/odata/v2/ODataModel","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/Fragment","sap/ui/core/ValueState"],(e,t,s,a,i,r,o)=>{"use strict";return e.extend("com.ram.travels.controller.HomePage",{onInit(){var e="/odata/v2/user/";this.oModel=new s(e,true);this.getView().setModel(this.oModel)},onRegister:async function(){if(!this.registerDialog){this.registerDialog=await r.load({name:"com.ram.travels.view.RegisterDialog",controller:this});this.getView().addDependent(this.registerDialog)}this.registerDialog.open()},onCloseRegister:function(){this.registerDialog.close()},onSubmitRegister:function(){let e=sap.ui.getCore().byId("firstName").getValue();let t=sap.ui.getCore().byId("lastName").getValue();let s=sap.ui.getCore().byId("mobileNumber").getValue();let a=sap.ui.getCore().byId("gender").getValue();let r=sap.ui.getCore().byId("emailId").getValue();let l=sap.ui.getCore().byId("password").getValue();let u=sap.ui.getCore().byId("confirmPassword").getValue();if(!e||!t||!s||!a||!r||!l){i.information("Please fill in all required fields.");return}if(s.length!==10){sap.ui.getCore().byId("mobileNumber").setValueState(o.Error);sap.ui.getCore().byId("mobileNumber").setValueStateText("Mobile Number should be exactly 10 digits");return}else{sap.ui.getCore().byId("mobileNumber").setValueState(o.None)}let n=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;if(!n.test(r)){sap.ui.getCore().byId("emailId").setValueState(o.Error);sap.ui.getCore().byId("emailId").setValueStateText("Please Enter a valid email address.");return}else{sap.ui.getCore().byId("emailId").setValueState(o.None)}let d=/^(?=.*[!@#$%^&*(),.?":{}|<>]).{9,}$/;if(!d.test(l)){sap.ui.getCore().byId("password").setValueState(o.Error);sap.ui.getCore().byId("password").setValueStateText("Password must be longer than 8 characters and atleast one special character.");return}else{sap.ui.getCore().byId("password").setValueState(o.None)}if(l!==u){i.information("Password and Confirm Password should be the same.");return}const g={firstName:e,lastName:t,mobileNumber:s,gender:a,emailId:r,Password:l};this.oModel.create("/Users",g,{success:()=>{i.success("Resgistration Successful!");this.onRegisterClear();this.registerDialog.close()},error:e=>{i.error("Registration failed!");console.error("Error:",e)}})},onRegisterClear:function(){sap.ui.getCore().byId("firstName").setValue("");sap.ui.getCore().byId("lastName").setValue("");sap.ui.getCore().byId("mobileNumber").setValue("");sap.ui.getCore().byId("gender").setValue("");sap.ui.getCore().byId("emailId").setValue("");sap.ui.getCore().byId("password").setValue("");sap.ui.getCore().byId("confirmPassword").setValue("")},onLogin:async function(){if(this.loginDialog===undefined){this.loginDialog=sap.ui.xmlfragment(this.getView().getId(),"com.ram.travels.view.LoginDialog",this);this.getView().addDependent(this.loginDialog)}this.loginDialog.open()},onCloseLogin:function(){this.loginDialog.close()},onSubmitLogin:function(){let e=this.getView().byId("idUserName").getValue().trim();let t=this.getView().byId("idPassword").getValue().trim();let s=false;var a=0;this.oModel.read("/Users",{success:function(r){console.log(r,"oData");for(let o=0;o<r.results.length;o++){let l=r.results[o].emailId;let u=r.results[o].Password;if(e===l&&t===u){i.information("Login Successfull!");s=true;a=0;break}else{a++}}if(!s){i.information("Wrong credentials. Please check your email and password.")}}.bind(this),error:function(){i.error("Failed to fetch user data.")}})}})});
//# sourceMappingURL=HomePage.controller.js.map